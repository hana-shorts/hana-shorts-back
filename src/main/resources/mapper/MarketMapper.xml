<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.kopo.hanashorts.market.mapper.MarketMapper">

  <!-- 기존 currencies 쿼리 -->
  <select id="getAllCurrencies" resultType="com.kopo.hanashorts.market.model.CurrencyDataDTO">
    SELECT
      currency_name AS currencyName,
      buy_price AS buyPrice,
      sell_price AS sellPrice,
      high_price AS highPrice,
      low_price AS lowPrice,
      change_value AS changeValue,
      change_percent AS changePercent,
      update_time AS rateTime
    FROM market_currency_price ORDER BY id
  </select>

  <!-- currencyPeriods 쿼리 -->
  <select id="getAllCurrencyPeriods" resultType="com.kopo.hanashorts.market.model.CurrencyPeriodDataDTO">
    SELECT
      currency_name AS currencyName,
      period_daily AS periodDaily,
      period_weekly AS periodWeekly,
      period_monthly AS periodMonthly,
      period_ytd AS periodYtd,
      period_yearly AS periodYearly,
      period_3years AS period3Years
    FROM market_currency_performance ORDER BY id
  </select>

  <!-- commodities 쿼리 -->
  <select id="getAllCommodities" resultType="com.kopo.hanashorts.market.model.CommodityDataDTO">
    SELECT
      commodity_name AS commodityName,
      contract_month AS contractMonth,
      closing_price AS closingPrice,
      high_price AS highPrice,
      low_price AS lowPrice,
      change_value AS changeValue,
      change_percent AS changePercent,
      update_time AS rateTime
    FROM market_commodity_price ORDER BY id
  </select>

  <!-- commodityPeriods 쿼리 -->
  <select id="getAllCommodityPeriods" resultType="com.kopo.hanashorts.market.model.CommodityPeriodDataDTO">
    SELECT
      commodity_name AS commodityName,
      period_daily AS periodDaily,
      period_weekly AS periodWeekly,
      period_monthly AS periodMonthly,
      period_ytd AS periodYtd,
      period_yearly AS periodYearly,
      period_3years AS period3Years
    FROM market_commodity_performance ORDER BY id
  </select>

  <!-- indices 쿼리 -->
  <select id="getAllIndices" resultType="com.kopo.hanashorts.market.model.IndexDataDTO">
    SELECT
      index_name AS indexName,
      closing_price AS closingPrice,
      high_price AS highPrice,
      low_price AS lowPrice,
      change_value AS changeValue,
      change_percent AS changePercent,
      update_time AS rateTime
    FROM market_index_price ORDER BY id
  </select>

  <!-- indexPeriods 쿼리 -->
  <select id="getAllIndexPeriods" resultType="com.kopo.hanashorts.market.model.IndexPeriodDataDTO">
    SELECT
      index_name AS indexName,
      period_daily AS periodDaily,
      period_weekly AS periodWeekly,
      period_monthly AS periodMonthly,
      period_ytd AS periodYtd,
      period_yearly AS periodYearly,
      period_3years AS period3Years
    FROM market_index_performance ORDER BY id
  </select>

  <!-- stocks 쿼리 -->
  <select id="getAllStocks" resultType="com.kopo.hanashorts.market.model.StockDataDTO">
    SELECT
      stock_name AS stockName,
      closing_price AS closingPrice,
      high_price AS highPrice,
      low_price AS lowPrice,
      change_value AS changeValue,
      change_percent AS changePercent,
      volume AS volume,
      update_time AS rateTime
    FROM market_stock_price
    ORDER BY
        CASE
            WHEN volume LIKE '%K' THEN (CAST(REPLACE(volume, 'K', '') AS FLOAT) * 1000)
            WHEN volume LIKE '%M' THEN (CAST(REPLACE(volume, 'M', '') AS FLOAT) * 1000000)
            ELSE CAST(volume AS FLOAT)
        END DESC
  </select>

  <!-- stockPeriods 쿼리 -->
  <select id="getAllStockPeriods" resultType="com.kopo.hanashorts.market.model.StockPeriodDataDTO">
    SELECT
      stock_name AS stockName,
      period_daily AS periodDaily,
      period_weekly AS periodWeekly,
      period_monthly AS periodMonthly,
      period_ytd AS periodYtd,
      period_yearly AS periodYearly,
      period_3years AS period3Years
    FROM market_stock_performance ORDER BY id
  </select>










</mapper>
